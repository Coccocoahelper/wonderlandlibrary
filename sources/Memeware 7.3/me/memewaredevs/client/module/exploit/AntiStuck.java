package me.memewaredevs.client.module.exploit;

import me.hippo.api.lwjeb.annotation.Handler;
import me.memewaredevs.client.event.events.PacketOutEvent;
import me.memewaredevs.client.event.events.UpdateEvent;
import me.memewaredevs.client.module.Module;
import me.memewaredevs.client.util.misc.Timer;
import net.minecraft.network.play.client.C03PacketPlayer;

import java.util.function.Consumer;

public class AntiStuck extends Module {
    private final Timer timer = new Timer();

    public AntiStuck(final String name, final int key, final Module.Category category) {
        super(name, key, category);
    }

    @Handler
    public Consumer<UpdateEvent> onUpdate = event -> {
        if (timer.delay(5000)) {
            this.toggle();
            timer.reset();
        }
    };

    @Override
    public void onEnable() {
        timer.reset();
    }

    @Handler
    public void onPacket(PacketOutEvent e) {
        if (e.getPacket() instanceof C03PacketPlayer) {
            e.cancel();
        }
    }
}
