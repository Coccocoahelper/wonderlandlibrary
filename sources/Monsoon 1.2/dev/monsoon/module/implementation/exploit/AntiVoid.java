package dev.monsoon.module.implementation.exploit;


import org.lwjgl.input.Keyboard;

import dev.monsoon.event.Event;
import dev.monsoon.event.listeners.EventMotion;
import dev.monsoon.module.base.Module;
import net.minecraft.util.AxisAlignedBB;
import dev.monsoon.util.misc.Timer;
import dev.monsoon.module.enums.Category;

public class AntiVoid extends Module {

    public AntiVoid() {
        super("AntiVoid", Keyboard.KEY_NONE, Category.EXPLOIT);
    }

    public Timer timer = new Timer();

    @Override
    public void onEnable() {
        timer.reset();
    }

    @Override
    public void onDisable() {
        mc.timer.timerSpeed = 1.0f;
    }

    public boolean isBlockUnder() {
        for (int offset = 0; offset < mc.thePlayer.posY - 10; offset += 2) {
            AxisAlignedBB boundingBox = mc.thePlayer.getEntityBoundingBox().offset(0, -offset, 0);

            if (!mc.theWorld.getCollidingBoundingBoxes(mc.thePlayer, boundingBox).isEmpty())
                return true;
        }
        return false;
    }

    public void onEvent(Event e) {
        if (e instanceof EventMotion && e.isPre()) {
            if (!isBlockUnder() && mc.thePlayer.fallDistance > 6 && mc.thePlayer.ticksExisted % 5 == 0 && !mc.thePlayer.isDead && !(mc.thePlayer.posY > 100) && !(mc.thePlayer.posY < 50)) {
                //(timer.hasTimeElapsed(2000, false)) {
                    mc.thePlayer.motionY = 2;
                //}
            }
        }
    }
}