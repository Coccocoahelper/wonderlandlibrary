package dev.monsoon.module.implementation.exploit;

import dev.monsoon.event.Event;
import dev.monsoon.event.listeners.EventUpdate;
import dev.monsoon.module.base.Module;
import dev.monsoon.module.setting.impl.ModeSetting;
import dev.monsoon.module.setting.impl.NumberSetting;
import net.minecraft.block.Block;
import net.minecraft.block.BlockBed;
import net.minecraft.block.BlockCake;
import net.minecraft.block.BlockDragonEgg;
import net.minecraft.network.play.client.C07PacketPlayerDigging;
import net.minecraft.util.BlockPos;
import net.minecraft.util.EnumFacing;
import org.lwjgl.input.Keyboard;
import dev.monsoon.module.enums.Category;

public class Breaker extends Module {
	public NumberSetting range;
	public ModeSetting Choose = new ModeSetting("Target", this,"Beds", "Beds", "Cakes", "Eggs");

	public Breaker() {
		super("Breaker", Keyboard.KEY_NONE, Category.EXPLOIT);
		this.range = new NumberSetting("Range", 1.0, 1.0, 6.0, 1.0,this);
		this.addSettings(Choose, range);
	}

	@Override
	public void onEnable() {
	}

	@Override
	public void onDisable() {
	}

	@Override
	public void onEvent(Event event) {
		if (event instanceof EventUpdate && event.isPre()) {
			int n = (int)this.range.getValue();
			for (int i = -n; i < n; ++i) {
				for (int j = n; j > -n; --j) {
					for (int k = -n; k < n; ++k) {
						int n2 = (int)this.mc.thePlayer.posX + i;
						int n3 = (int)this.mc.thePlayer.posY + j;
						int n4 = (int)this.mc.thePlayer.posZ + k;
						BlockPos blockPos = new BlockPos(n2, n3, n4);
						Block block = this.mc.theWorld.getBlockState(blockPos).getBlock();
						if (this.Choose.is("Beds") && block instanceof BlockBed) {
							this.mc.thePlayer.swingItem();
							this.mc.getNetHandler().addToSendQueue(new C07PacketPlayerDigging(C07PacketPlayerDigging.Action.START_DESTROY_BLOCK, blockPos, EnumFacing.DOWN));
							this.mc.getNetHandler().addToSendQueue(new C07PacketPlayerDigging(C07PacketPlayerDigging.Action.STOP_DESTROY_BLOCK, blockPos, EnumFacing.DOWN));
						}
						if (this.Choose.is("Cakes") && block instanceof BlockCake) {
							this.mc.thePlayer.swingItem();
							this.mc.getNetHandler().addToSendQueue(new C07PacketPlayerDigging(C07PacketPlayerDigging.Action.START_DESTROY_BLOCK, blockPos, EnumFacing.DOWN));
							this.mc.getNetHandler().addToSendQueue(new C07PacketPlayerDigging(C07PacketPlayerDigging.Action.STOP_DESTROY_BLOCK, blockPos, EnumFacing.DOWN));
						}
						if (!this.Choose.is("Eggs") || !(block instanceof BlockDragonEgg)) continue;
							this.mc.thePlayer.swingItem();
							this.mc.getNetHandler().addToSendQueue(new C07PacketPlayerDigging(C07PacketPlayerDigging.Action.START_DESTROY_BLOCK, blockPos, EnumFacing.DOWN));
							this.mc.getNetHandler().addToSendQueue(new C07PacketPlayerDigging(C07PacketPlayerDigging.Action.STOP_DESTROY_BLOCK, blockPos, EnumFacing.DOWN));
					}
				}
			}
		}
	}
}
