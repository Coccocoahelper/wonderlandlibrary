/*
 * Decompiled with CFR 0.152.
 */
package tk.rektsky.module.impl.exploits;

import net.minecraft.network.play.client.C0BPacketEntityAction;
import net.minecraft.network.play.server.S20PacketEntityProperties;
import org.greenrobot.eventbus.Subscribe;
import tk.rektsky.Client;
import tk.rektsky.event.impl.PacketReceiveEvent;
import tk.rektsky.event.impl.PacketSentEvent;
import tk.rektsky.event.impl.WorldTickEvent;
import tk.rektsky.module.Category;
import tk.rektsky.module.Module;

public class ForceSprint
extends Module {
    boolean sprinting = false;

    public ForceSprint() {
        super("ForceSprint", "So you won't be hungry when you sprint", Category.EXPLOIT);
    }

    @Override
    public void onEnable() {
    }

    @Subscribe
    public void worldTick(WorldTickEvent event) {
        if (this.mc.thePlayer.movementInput.moveStrafe == 0.0f) {
            if (!this.sprinting) {
                this.sprinting = true;
                this.mc.thePlayer.sendQueue.addToSendQueueSilent(new C0BPacketEntityAction(this.mc.thePlayer, C0BPacketEntityAction.Action.START_SPRINTING));
            }
        } else if (this.sprinting) {
            this.sprinting = false;
            this.mc.thePlayer.sendQueue.addToSendQueueSilent(new C0BPacketEntityAction(this.mc.thePlayer, C0BPacketEntityAction.Action.STOP_SPRINTING));
        }
    }

    @Subscribe
    public void onRecieve(PacketReceiveEvent event) {
        if (event.getPacket() instanceof S20PacketEntityProperties && ((S20PacketEntityProperties)event.getPacket()).getEntityId() == this.mc.thePlayer.getEntityId()) {
            for (S20PacketEntityProperties.Snapshot snapshot : ((S20PacketEntityProperties)event.getPacket()).func_149441_d()) {
                Client.addClientChat(snapshot.func_151409_a());
            }
        }
    }

    @Subscribe
    public void onPacket(PacketSentEvent event) {
        if (event.getPacket() instanceof C0BPacketEntityAction) {
            if (((C0BPacketEntityAction)event.getPacket()).getAction() == C0BPacketEntityAction.Action.STOP_SPRINTING) {
                event.setCanceled(true);
            }
            if (((C0BPacketEntityAction)event.getPacket()).getAction() == C0BPacketEntityAction.Action.START_SPRINTING) {
                event.setCanceled(true);
            }
        }
    }
}

