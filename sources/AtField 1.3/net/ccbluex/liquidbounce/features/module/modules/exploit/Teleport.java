/*
 * Decompiled with CFR 0.152.
 * 
 * Could not load the following classes:
 *  javax.vecmath.Vector3d
 *  org.lwjgl.input.Mouse
 *  org.lwjgl.opengl.GL11
 */
package net.ccbluex.liquidbounce.features.module.modules.exploit;

import java.awt.Color;
import java.util.ArrayList;
import java.util.Arrays;
import java.util.List;
import javax.vecmath.Vector3d;
import net.ccbluex.liquidbounce.api.enums.MaterialType;
import net.ccbluex.liquidbounce.api.minecraft.block.state.IIBlockState;
import net.ccbluex.liquidbounce.api.minecraft.client.entity.IEntityPlayerSP;
import net.ccbluex.liquidbounce.api.minecraft.network.IPacket;
import net.ccbluex.liquidbounce.api.minecraft.network.play.client.ICPacketEntityAction;
import net.ccbluex.liquidbounce.api.minecraft.network.play.client.ICPacketPlayer;
import net.ccbluex.liquidbounce.api.minecraft.renderer.entity.IRenderManager;
import net.ccbluex.liquidbounce.api.minecraft.util.IMovingObjectPosition;
import net.ccbluex.liquidbounce.api.minecraft.util.WBlockPos;
import net.ccbluex.liquidbounce.api.minecraft.util.WVec3;
import net.ccbluex.liquidbounce.event.EventTarget;
import net.ccbluex.liquidbounce.event.MoveEvent;
import net.ccbluex.liquidbounce.event.PacketEvent;
import net.ccbluex.liquidbounce.event.Render3DEvent;
import net.ccbluex.liquidbounce.event.UpdateEvent;
import net.ccbluex.liquidbounce.features.module.Module;
import net.ccbluex.liquidbounce.features.module.ModuleCategory;
import net.ccbluex.liquidbounce.features.module.ModuleInfo;
import net.ccbluex.liquidbounce.utils.ClientUtils;
import net.ccbluex.liquidbounce.utils.MovementUtils;
import net.ccbluex.liquidbounce.utils.PathUtils;
import net.ccbluex.liquidbounce.utils.block.BlockUtils;
import net.ccbluex.liquidbounce.utils.render.RenderUtils;
import net.ccbluex.liquidbounce.utils.timer.TickTimer;
import net.ccbluex.liquidbounce.value.BoolValue;
import net.ccbluex.liquidbounce.value.ListValue;
import org.lwjgl.input.Mouse;
import org.lwjgl.opengl.GL11;

@ModuleInfo(name="Teleport", description="Allows you to teleport around.", category=ModuleCategory.EXPLOIT)
public class Teleport
extends Module {
    private WBlockPos endPos;
    private final List packets;
    private final ListValue buttonValue;
    private IMovingObjectPosition objectPosition;
    private final BoolValue ignoreNoCollision = new BoolValue("IgnoreNoCollision", true);
    private int delay;
    private final TickTimer flyTimer;
    private final TickTimer freezeTimer;
    private boolean zitter = false;
    private boolean freeze = false;
    private boolean hadGround;
    private double fixedY;
    private final ListValue modeValue = new ListValue("Mode", new String[]{"Blink", "Flag", "Rewinside", "OldRewinside", "Spoof", "Minesucht", "AAC3.5.0"}, "Blink");
    private boolean doTeleport = false;
    private boolean disableLogger = false;

    private static void lambda$onUpdate$0(IPacket iPacket) {
        mc.getNetHandler().addToSendQueue(iPacket);
    }

    public Teleport() {
        this.buttonValue = new ListValue("Button", new String[]{"Left", "Right", "Middle"}, "Middle");
        this.flyTimer = new TickTimer();
        this.packets = new ArrayList();
        this.freezeTimer = new TickTimer();
    }

    @EventTarget
    public void onRender3D(Render3DEvent render3DEvent) {
        if (((String)this.modeValue.get()).equals("AAC3.5.0")) {
            return;
        }
        IEntityPlayerSP iEntityPlayerSP = mc.getThePlayer();
        if (iEntityPlayerSP == null) {
            return;
        }
        WVec3 wVec3 = iEntityPlayerSP.getLookVec();
        WVec3 wVec32 = new WVec3(wVec3.getXCoord() * 300.0, wVec3.getYCoord() * 300.0, wVec3.getZCoord() * 300.0);
        WVec3 wVec33 = new WVec3(iEntityPlayerSP.getPosX(), iEntityPlayerSP.getPosY() + 1.62, iEntityPlayerSP.getPosZ());
        this.objectPosition = mc.getTheWorld().rayTraceBlocks(wVec33, wVec33.add(wVec32), false, (Boolean)this.ignoreNoCollision.get(), false);
        if (this.objectPosition == null || this.objectPosition.getBlockPos() == null) {
            return;
        }
        WBlockPos wBlockPos = new WBlockPos(this.objectPosition.getBlockPos().getX(), this.objectPosition.getBlockPos().getY() - 1, this.objectPosition.getBlockPos().getZ());
        this.fixedY = classProvider.isBlockFence(BlockUtils.getBlock(this.objectPosition.getBlockPos())) ? (mc.getTheWorld().getCollidingBoundingBoxes(iEntityPlayerSP, iEntityPlayerSP.getEntityBoundingBox().offset((double)this.objectPosition.getBlockPos().getX() + 0.5 - iEntityPlayerSP.getPosX(), (double)this.objectPosition.getBlockPos().getY() + 1.5 - iEntityPlayerSP.getPosY(), (double)this.objectPosition.getBlockPos().getZ() + 0.5 - iEntityPlayerSP.getPosZ())).isEmpty() ? 0.5 : 0.0) : (classProvider.isBlockFence(BlockUtils.getBlock(wBlockPos)) ? (!mc.getTheWorld().getCollidingBoundingBoxes(iEntityPlayerSP, iEntityPlayerSP.getEntityBoundingBox().offset((double)this.objectPosition.getBlockPos().getX() + 0.5 - iEntityPlayerSP.getPosX(), (double)this.objectPosition.getBlockPos().getY() + 0.5 - iEntityPlayerSP.getPosY(), (double)this.objectPosition.getBlockPos().getZ() + 0.5 - iEntityPlayerSP.getPosZ())).isEmpty() || BlockUtils.getBlock(this.objectPosition.getBlockPos()).getCollisionBoundingBox(mc.getTheWorld(), this.objectPosition.getBlockPos(), BlockUtils.getBlock(this.objectPosition.getBlockPos()).getDefaultState()) == null ? 0.0 : -0.5) : (classProvider.isBlockSnow(BlockUtils.getBlock(this.objectPosition.getBlockPos())) ? 0.875 : 0.0));
        int n = this.objectPosition.getBlockPos().getX();
        double d = (BlockUtils.getBlock(this.objectPosition.getBlockPos()).getCollisionBoundingBox(mc.getTheWorld(), this.objectPosition.getBlockPos(), BlockUtils.getBlock(this.objectPosition.getBlockPos()).getDefaultState()) == null ? (double)(this.objectPosition.getBlockPos().getY() + 1) : BlockUtils.getBlock(this.objectPosition.getBlockPos()).getCollisionBoundingBox(mc.getTheWorld(), this.objectPosition.getBlockPos(), BlockUtils.getBlock(this.objectPosition.getBlockPos()).getDefaultState()).getMaxY()) - 1.0 + this.fixedY;
        int n2 = this.objectPosition.getBlockPos().getZ();
        if (!classProvider.isBlockAir(BlockUtils.getBlock(this.objectPosition.getBlockPos()))) {
            IRenderManager iRenderManager = mc.getRenderManager();
            GL11.glBlendFunc((int)770, (int)771);
            GL11.glEnable((int)3042);
            GL11.glLineWidth((float)2.0f);
            GL11.glDisable((int)3553);
            GL11.glDisable((int)2929);
            GL11.glDepthMask((boolean)false);
            RenderUtils.glColor(((String)this.modeValue.get()).equalsIgnoreCase("minesucht") && (double)iEntityPlayerSP.getPosition().getY() != d + 1.0 ? new Color(255, 0, 0, 90) : (!mc.getTheWorld().getCollidingBoundingBoxes(iEntityPlayerSP, iEntityPlayerSP.getEntityBoundingBox().offset((double)n + 0.5 - iEntityPlayerSP.getPosX(), d + 1.0 - iEntityPlayerSP.getPosY(), (double)n2 + 0.5 - iEntityPlayerSP.getPosZ())).isEmpty() ? new Color(255, 0, 0, 90) : new Color(0, 255, 0, 90)));
            RenderUtils.drawFilledBox(classProvider.createAxisAlignedBB((double)n - iRenderManager.getRenderPosX(), d + 1.0 - iRenderManager.getRenderPosY(), (double)n2 - iRenderManager.getRenderPosZ(), (double)n - iRenderManager.getRenderPosX() + 1.0, d + 1.2 - iRenderManager.getRenderPosY(), (double)n2 - iRenderManager.getRenderPosZ() + 1.0));
            GL11.glEnable((int)3553);
            GL11.glEnable((int)2929);
            GL11.glDepthMask((boolean)true);
            GL11.glDisable((int)3042);
            RenderUtils.renderNameTag(Math.round(iEntityPlayerSP.getDistance((double)n + 0.5, d + 1.0, (double)n2 + 0.5)) + "m", (double)n + 0.5, d + 1.7, (double)n2 + 0.5);
            GL11.glColor4f((float)1.0f, (float)1.0f, (float)1.0f, (float)1.0f);
        }
    }

    @EventTarget
    public void onMove(MoveEvent moveEvent) {
        if (((String)this.modeValue.get()).equalsIgnoreCase("aac3.5.0") && this.freeze) {
            moveEvent.zeroXZ();
        }
    }

    @Override
    public String getTag() {
        return (String)this.modeValue.get();
    }

    @EventTarget
    public void onUpdate(UpdateEvent updateEvent) {
        int n = Arrays.asList(this.buttonValue.getValues()).indexOf(this.buttonValue.get());
        IEntityPlayerSP iEntityPlayerSP = mc.getThePlayer();
        if (iEntityPlayerSP == null) {
            return;
        }
        if (((String)this.modeValue.get()).equals("AAC3.5.0")) {
            this.freezeTimer.update();
            if (this.freeze && this.freezeTimer.hasTimePassed(40)) {
                this.freezeTimer.reset();
                this.freeze = false;
                this.setState(false);
            }
            if (!this.flyTimer.hasTimePassed(60)) {
                this.flyTimer.update();
                if (iEntityPlayerSP.getOnGround()) {
                    iEntityPlayerSP.jump();
                } else {
                    MovementUtils.forward(this.zitter ? -0.21 : 0.21);
                    this.zitter = !this.zitter;
                }
                this.hadGround = false;
                return;
            }
            if (iEntityPlayerSP.getOnGround()) {
                this.hadGround = true;
            }
            if (!this.hadGround) {
                return;
            }
            if (iEntityPlayerSP.getOnGround()) {
                iEntityPlayerSP.setPositionAndUpdate(iEntityPlayerSP.getPosX(), iEntityPlayerSP.getPosY() + 0.2, iEntityPlayerSP.getPosZ());
            }
            float f = 2.0f;
            iEntityPlayerSP.getCapabilities().setFlying(false);
            iEntityPlayerSP.setMotionX(0.0);
            iEntityPlayerSP.setMotionY(0.0);
            iEntityPlayerSP.setMotionZ(0.0);
            if (mc.getGameSettings().getKeyBindJump().isKeyDown()) {
                iEntityPlayerSP.setMotionY(iEntityPlayerSP.getMotionY() + 2.0);
            }
            if (mc.getGameSettings().getKeyBindSneak().isKeyDown()) {
                iEntityPlayerSP.setMotionY(iEntityPlayerSP.getMotionY() - 2.0);
            }
            MovementUtils.strafe(2.0f);
            if (Mouse.isButtonDown((int)n) && !this.doTeleport) {
                iEntityPlayerSP.setPositionAndUpdate(iEntityPlayerSP.getPosX(), iEntityPlayerSP.getPosY() - 11.0, iEntityPlayerSP.getPosZ());
                this.disableLogger = true;
                this.packets.forEach(Teleport::lambda$onUpdate$0);
                this.freezeTimer.reset();
                this.freeze = true;
            }
            this.doTeleport = Mouse.isButtonDown((int)n);
            return;
        }
        if (mc.getCurrentScreen() == null && Mouse.isButtonDown((int)n) && this.delay <= 0) {
            this.endPos = this.objectPosition.getBlockPos();
            IIBlockState iIBlockState = BlockUtils.getState(this.endPos);
            if (iIBlockState.getBlock().getMaterial(iIBlockState).equals(classProvider.getMaterialEnum(MaterialType.AIR))) {
                this.endPos = null;
                return;
            }
            ClientUtils.displayChatMessage("\u00a77[\u00a78\u00a7lTeleport\u00a77] \u00a73Position was set to \u00a78" + this.endPos.getX() + "\u00a73, \u00a78" + ((BlockUtils.getBlock(this.objectPosition.getBlockPos()).getCollisionBoundingBox(mc.getTheWorld(), this.objectPosition.getBlockPos(), BlockUtils.getBlock(this.objectPosition.getBlockPos()).getDefaultState()) == null ? (double)(this.endPos.getY() + 1) : BlockUtils.getBlock(this.objectPosition.getBlockPos()).getCollisionBoundingBox(mc.getTheWorld(), this.objectPosition.getBlockPos(), BlockUtils.getBlock(this.objectPosition.getBlockPos()).getDefaultState()).getMaxY()) + this.fixedY) + "\u00a73, \u00a78" + this.endPos.getZ());
            this.delay = 6;
        }
        if (this.delay > 0) {
            --this.delay;
        }
        if (this.endPos != null) {
            double d = (double)this.endPos.getX() + 0.5;
            double d2 = (BlockUtils.getBlock(this.objectPosition.getBlockPos()).getCollisionBoundingBox(mc.getTheWorld(), this.objectPosition.getBlockPos(), BlockUtils.getBlock(this.objectPosition.getBlockPos()).getDefaultState()) == null ? (double)(this.endPos.getY() + 1) : BlockUtils.getBlock(this.objectPosition.getBlockPos()).getCollisionBoundingBox(mc.getTheWorld(), this.objectPosition.getBlockPos(), BlockUtils.getBlock(this.objectPosition.getBlockPos()).getDefaultState()).getMaxY()) + this.fixedY;
            double d3 = (double)this.endPos.getZ() + 0.5;
            switch (((String)this.modeValue.get()).toLowerCase()) {
                case "blink": {
                    if (!iEntityPlayerSP.isSneaking()) break;
                    mc.getNetHandler().addToSendQueue(classProvider.createCPacketEntityAction(iEntityPlayerSP, ICPacketEntityAction.WAction.STOP_SNEAKING));
                    PathUtils.findBlinkPath(d, d2, d3).forEach(arg_0 -> Teleport.lambda$onUpdate$1(iEntityPlayerSP, d, d2, d3, arg_0));
                    mc.getNetHandler().addToSendQueue(classProvider.createCPacketEntityAction(iEntityPlayerSP, ICPacketEntityAction.WAction.START_SNEAKING));
                    ClientUtils.displayChatMessage("\u00a77[\u00a78\u00a7lTeleport\u00a77] \u00a73You were teleported to \u00a78" + d + "\u00a73, \u00a78" + d2 + "\u00a73, \u00a78" + d3);
                    break;
                }
                case "flag": {
                    if (!iEntityPlayerSP.isSneaking()) break;
                    mc.getNetHandler().addToSendQueue(classProvider.createCPacketEntityAction(iEntityPlayerSP, ICPacketEntityAction.WAction.STOP_SNEAKING));
                    mc.getNetHandler().addToSendQueue(classProvider.createCPacketPlayerPosition(iEntityPlayerSP.getPosX(), iEntityPlayerSP.getPosY(), iEntityPlayerSP.getPosZ(), true));
                    mc.getNetHandler().addToSendQueue(classProvider.createCPacketPlayerPosition(d, d2, d3, true));
                    mc.getNetHandler().addToSendQueue(classProvider.createCPacketPlayerPosition(iEntityPlayerSP.getPosX(), iEntityPlayerSP.getPosY(), iEntityPlayerSP.getPosZ(), true));
                    mc.getNetHandler().addToSendQueue(classProvider.createCPacketPlayerPosition(iEntityPlayerSP.getPosX(), iEntityPlayerSP.getPosY() + 5.0, iEntityPlayerSP.getPosZ(), true));
                    mc.getNetHandler().addToSendQueue(classProvider.createCPacketPlayerPosition(d, d2, d3, true));
                    mc.getNetHandler().addToSendQueue(classProvider.createCPacketPlayerPosition(iEntityPlayerSP.getPosX() + 0.5, iEntityPlayerSP.getPosY(), iEntityPlayerSP.getPosZ() + 0.5, true));
                    MovementUtils.forward(0.04);
                    mc.getNetHandler().addToSendQueue(classProvider.createCPacketEntityAction(iEntityPlayerSP, ICPacketEntityAction.WAction.START_SNEAKING));
                    ClientUtils.displayChatMessage("\u00a77[\u00a78\u00a7lTeleport\u00a77] \u00a73You were teleported to \u00a78" + d + "\u00a73, \u00a78" + d2 + "\u00a73, \u00a78" + d3);
                    break;
                }
                case "rewinside": {
                    iEntityPlayerSP.setMotionY(0.1);
                    mc.getNetHandler().addToSendQueue(classProvider.createCPacketPlayerPosition(d, d2, d3, true));
                    mc.getNetHandler().addToSendQueue(classProvider.createCPacketPlayerPosition(iEntityPlayerSP.getPosX(), iEntityPlayerSP.getPosY() + 0.6, iEntityPlayerSP.getPosZ(), true));
                    if ((int)iEntityPlayerSP.getPosX() == (int)d && (int)iEntityPlayerSP.getPosY() == (int)d2 && (int)iEntityPlayerSP.getPosZ() == (int)d3) {
                        ClientUtils.displayChatMessage("\u00a77[\u00a78\u00a7lTeleport\u00a77] \u00a73You were teleported to \u00a78" + d + "\u00a73, \u00a78" + d2 + "\u00a73, \u00a78" + d3);
                        this.endPos = null;
                        break;
                    }
                    ClientUtils.displayChatMessage("\u00a77[\u00a78\u00a7lTeleport\u00a77] \u00a73Teleport try...");
                    break;
                }
                case "oldrewinside": {
                    iEntityPlayerSP.setMotionY(0.1);
                    mc.getNetHandler().addToSendQueue(classProvider.createCPacketPlayerPosition(iEntityPlayerSP.getPosX(), iEntityPlayerSP.getPosY(), iEntityPlayerSP.getPosZ(), true));
                    mc.getNetHandler().addToSendQueue(classProvider.createCPacketPlayerPosition(d, d2, d3, true));
                    mc.getNetHandler().addToSendQueue(classProvider.createCPacketPlayerPosition(iEntityPlayerSP.getPosX(), iEntityPlayerSP.getPosY(), iEntityPlayerSP.getPosZ(), true));
                    mc.getNetHandler().addToSendQueue(classProvider.createCPacketPlayerPosition(iEntityPlayerSP.getPosX(), iEntityPlayerSP.getPosY(), iEntityPlayerSP.getPosZ(), true));
                    mc.getNetHandler().addToSendQueue(classProvider.createCPacketPlayerPosition(d, d2, d3, true));
                    mc.getNetHandler().addToSendQueue(classProvider.createCPacketPlayerPosition(iEntityPlayerSP.getPosX(), iEntityPlayerSP.getPosY(), iEntityPlayerSP.getPosZ(), true));
                    if ((int)iEntityPlayerSP.getPosX() == (int)d && (int)iEntityPlayerSP.getPosY() == (int)d2 && (int)iEntityPlayerSP.getPosZ() == (int)d3) {
                        ClientUtils.displayChatMessage("\u00a77[\u00a78\u00a7lTeleport\u00a77] \u00a73You were teleported to \u00a78" + d + "\u00a73, \u00a78" + d2 + "\u00a73, \u00a78" + d3);
                        this.endPos = null;
                    } else {
                        ClientUtils.displayChatMessage("\u00a77[\u00a78\u00a7lTeleport\u00a77] \u00a73Teleport try...");
                    }
                    MovementUtils.forward(0.04);
                    break;
                }
                case "minesucht": {
                    if (!iEntityPlayerSP.isSneaking()) break;
                    mc.getNetHandler().addToSendQueue(classProvider.createCPacketPlayerPosition(d, d2, d3, true));
                    ClientUtils.displayChatMessage("\u00a77[\u00a78\u00a7lTeleport\u00a77] \u00a73You were teleported to \u00a78" + d + "\u00a73, \u00a78" + d2 + "\u00a73, \u00a78" + d3);
                }
            }
        }
    }

    @Override
    public void onDisable() {
        this.fixedY = 0.0;
        this.delay = 0;
        mc.getTimer().setTimerSpeed(1.0f);
        this.endPos = null;
        this.hadGround = false;
        this.freeze = false;
        this.disableLogger = false;
        this.flyTimer.reset();
        this.packets.clear();
        super.onDisable();
    }

    @Override
    public void onEnable() {
        if (((String)this.modeValue.get()).equalsIgnoreCase("AAC3.5.0")) {
            ClientUtils.displayChatMessage("\u00a7c>>> \u00a7a\u00a7lTeleport \u00a7fAAC 3.5.0 \u00a7c<<<");
            ClientUtils.displayChatMessage("\u00a7cHow to teleport: \u00a7aPress " + (String)this.buttonValue.get() + " mouse button.");
            ClientUtils.displayChatMessage("\u00a7cHow to cancel teleport: \u00a7aDisable teleport module.");
        }
    }

    private static void lambda$onUpdate$1(IEntityPlayerSP iEntityPlayerSP, double d, double d2, double d3, Vector3d vector3d) {
        mc.getNetHandler().addToSendQueue(classProvider.createCPacketPlayerPosition(vector3d.x, vector3d.y, vector3d.z, true));
        iEntityPlayerSP.setPosition(d, d2, d3);
    }

    @EventTarget
    public void onPacket(PacketEvent packetEvent) {
        IPacket iPacket = packetEvent.getPacket();
        if (this.disableLogger) {
            return;
        }
        if (classProvider.isCPacketPlayer(iPacket)) {
            ICPacketPlayer iCPacketPlayer = iPacket.asCPacketPlayer();
            switch (((String)this.modeValue.get()).toLowerCase()) {
                case "spoof": {
                    if (this.endPos == null) break;
                    iCPacketPlayer.setX((double)this.endPos.getX() + 0.5);
                    iCPacketPlayer.setY(this.endPos.getY() + 1);
                    iCPacketPlayer.setZ((double)this.endPos.getZ() + 0.5);
                    mc.getThePlayer().setPosition((double)this.endPos.getX() + 0.5, this.endPos.getY() + 1, (double)this.endPos.getZ() + 0.5);
                    break;
                }
                case "aac3.5.0": {
                    if (!this.flyTimer.hasTimePassed(60)) {
                        return;
                    }
                    packetEvent.cancelEvent();
                    if (!classProvider.isCPacketPlayerPosition(iPacket) && !classProvider.isCPacketPlayerPosLook(iPacket)) {
                        return;
                    }
                    this.packets.add(iPacket);
                }
            }
        }
    }
}

