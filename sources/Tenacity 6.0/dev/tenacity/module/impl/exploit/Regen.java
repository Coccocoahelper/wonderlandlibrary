// 
// Decompiled by Procyon v0.5.36
// 

package dev.tenacity.module.impl.exploit;

import dev.tenacity.module.settings.Setting;
import dev.tenacity.module.Category;
import net.minecraft.network.Packet;
import dev.tenacity.utils.server.PacketUtils;
import net.minecraft.network.play.client.C03PacketPlayer;
import dev.tenacity.event.impl.player.MotionEvent;
import dev.tenacity.module.settings.impl.NumberSetting;
import dev.tenacity.module.settings.impl.ModeSetting;
import dev.tenacity.module.Module;

public final class Regen extends Module
{
    private final ModeSetting mode;
    private final NumberSetting health;
    private boolean teleported;
    
    @Override
    public void onMotionEvent(final MotionEvent event) {
        this.setSuffix(this.mode.getMode());
        final String mode = this.mode.getMode();
        switch (mode) {
            case "Vanilla": {
                if (Regen.mc.thePlayer.getFoodStats().getFoodLevel() > 3 && Regen.mc.thePlayer.getHealth() <= this.health.getValue().floatValue()) {
                    for (int i = 0; i < 5; ++i) {
                        PacketUtils.sendPacketNoEvent(new C03PacketPlayer(true));
                    }
                    break;
                }
                break;
            }
            case "Vifa": {
                if (Regen.mc.thePlayer.getFoodStats().getFoodLevel() <= 3 || Regen.mc.thePlayer.getHealth() > this.health.getValue().floatValue()) {
                    this.teleported = false;
                    break;
                }
                if (!this.teleported) {
                    Regen.mc.thePlayer.setPosition(Regen.mc.thePlayer.posX, -999.0, Regen.mc.thePlayer.posZ);
                    if (!Regen.mc.thePlayer.onGround) {
                        this.teleported = true;
                    }
                }
                if (this.teleported) {
                    for (int i = 0; i < 20; ++i) {
                        PacketUtils.sendPacketNoEvent(new C03PacketPlayer.C04PacketPlayerPosition(Regen.mc.thePlayer.lastTickPosX, Regen.mc.thePlayer.lastTickPosY, Regen.mc.thePlayer.lastTickPosZ, false));
                    }
                    Regen.mc.thePlayer.setPositionAndUpdate(Regen.mc.thePlayer.posX, Regen.mc.thePlayer.posY, Regen.mc.thePlayer.posZ);
                    break;
                }
                break;
            }
        }
    }
    
    public Regen() {
        super("Regen", "Regen", Category.EXPLOIT, "regen hp faster");
        this.mode = new ModeSetting("Mode", "Vanilla", new String[] { "Vanilla", "Vifa" });
        this.health = new NumberSetting("Health", 1.0, 20.0, 1.0, 1.0);
        this.addSettings(this.mode, this.health);
    }
    
    @Override
    public void onDisable() {
        this.teleported = false;
        super.onDisable();
    }
}
